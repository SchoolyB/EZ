/*
 * enums.ez - Test enum definitions and usage
 */

import @std
using std

/* Basic int enum (auto-incremented 0, 1, 2, 3) */
const Direction enum {
    NORTH
    EAST
    SOUTH
    WEST
}

/* Flags enum with power-of-2 values (1, 2, 4, 8) */
@flags
const Permissions enum {
    READ      // 1
    WRITE     // 2
    EXECUTE   // 4
    DELETE    // 8
}

/* String enum with explicit values */
const Status enum {
    TODO = "todo"
    IN_PROGRESS = "in_progress"
    DONE = "done"
}

/* Explicit int enum (same as default) */
@enum(int)
const Priority enum {
    LOW       // 0
    MEDIUM    // 1
    HIGH      // 2
}

do main() {
    println("=== Enums Test ===")
    temp passed int = 0
    temp failed int = 0

    // ==================== BASIC INT ENUM ====================
    println("  -- Basic Int Enum --")

    // Test 1: first enum value is 0
    if Direction.NORTH == 0 {
        println("  [PASS] Direction.NORTH = 0")
        passed += 1
    } otherwise {
        println("  [FAIL] Direction.NORTH: expected 0, got ${Direction.NORTH}")
        failed += 1
    }

    // Test 2: auto-increment
    if Direction.EAST == 1 && Direction.SOUTH == 2 && Direction.WEST == 3 {
        println("  [PASS] enum auto-increment (1, 2, 3)")
        passed += 1
    } otherwise {
        println("  [FAIL] enum auto-increment")
        failed += 1
    }

    // Test 3: store enum in variable
    temp current int = Direction.SOUTH
    if current == 2 {
        println("  [PASS] enum value in variable")
        passed += 1
    } otherwise {
        println("  [FAIL] enum in variable: expected 2, got ${current}")
        failed += 1
    }

    // ==================== FLAGS ENUM ====================
    println("  -- Flags Enum (power-of-2) --")

    // Test 4: first flag value is 1
    if Permissions.READ == 1 {
        println("  [PASS] Permissions.READ = 1")
        passed += 1
    } otherwise {
        println("  [FAIL] Permissions.READ: expected 1, got ${Permissions.READ}")
        failed += 1
    }

    // Test 5: power-of-2 values
    if Permissions.WRITE == 2 {
        println("  [PASS] Permissions.WRITE = 2")
        passed += 1
    } otherwise {
        println("  [FAIL] Permissions.WRITE: expected 2, got ${Permissions.WRITE}")
        failed += 1
    }

    // Test 6: continue power-of-2
    if Permissions.EXECUTE == 4 && Permissions.DELETE == 8 {
        println("  [PASS] Permissions.EXECUTE=4, DELETE=8")
        passed += 1
    } otherwise {
        println("  [FAIL] flags enum: EXECUTE=${Permissions.EXECUTE}, DELETE=${Permissions.DELETE}")
        failed += 1
    }

    // ==================== STRING ENUM ====================
    println("  -- String Enum --")

    // Test 7: string enum value
    if Status.TODO == "todo" {
        println("  [PASS] Status.TODO = \"todo\"")
        passed += 1
    } otherwise {
        println("  [FAIL] Status.TODO: expected \"todo\", got \"${Status.TODO}\"")
        failed += 1
    }

    // Test 8: other string values
    if Status.IN_PROGRESS == "in_progress" && Status.DONE == "done" {
        println("  [PASS] Status.IN_PROGRESS and DONE")
        passed += 1
    } otherwise {
        println("  [FAIL] string enum values")
        failed += 1
    }

    // Test 9: string enum in variable
    temp current_status string = Status.IN_PROGRESS
    if current_status == "in_progress" {
        println("  [PASS] string enum in variable")
        passed += 1
    } otherwise {
        println("  [FAIL] string enum in variable: got \"${current_status}\"")
        failed += 1
    }

    // ==================== EXPLICIT INT ENUM ====================
    println("  -- Explicit @enum(int) --")

    // Test 10: @enum(int) works like default
    if Priority.LOW == 0 && Priority.MEDIUM == 1 && Priority.HIGH == 2 {
        println("  [PASS] @enum(int) auto-increment (0, 1, 2)")
        passed += 1
    } otherwise {
        println("  [FAIL] @enum(int): LOW=${Priority.LOW}, MEDIUM=${Priority.MEDIUM}, HIGH=${Priority.HIGH}")
        failed += 1
    }

    // ==================== ENUM COMPARISON ====================
    println("  -- Enum Comparison --")

    // Test 11: compare enum values
    temp priority int = Priority.HIGH
    if priority >= Priority.MEDIUM {
        println("  [PASS] enum comparison (HIGH >= MEDIUM)")
        passed += 1
    } otherwise {
        println("  [FAIL] enum comparison")
        failed += 1
    }

    // Summary
    println("")
    println("Results: ${passed} passed, ${failed} failed")

    if failed > 0 {
        println("SOME TESTS FAILED")
    } otherwise {
        println("ALL TESTS PASSED")
    }
}
