/*
 * loop_statement.ez - Test the loop (infinite loop) statement
 */

import @std
using std

do main() {
    println("=== Loop Statement Test ===")
    temp passed int = 0
    temp failed int = 0

    // Test 1: Basic loop with break
    temp count int = 0
    loop {
        if count == 5 {
            break
        }
        count++
    }
    if count == 5 {
        println("  [PASS] loop with break exits at count 5")
        passed += 1
    } otherwise {
        println("  [FAIL] loop with break: expected count 5, got ${count}")
        failed += 1
    }

    // Test 2: Loop with continue and break
    temp sum int = 0
    temp i int = 0
    loop {
        i++
        if i > 10 {
            break
        }
        if i % 2 == 0 {
            continue
        }
        sum += i
    }
    // sum of odd numbers 1-9: 1+3+5+7+9 = 25
    if sum == 25 {
        println("  [PASS] loop with continue skips evens, sum of odds 1-9 = 25")
        passed += 1
    } otherwise {
        println("  [FAIL] loop with continue: expected sum 25, got ${sum}")
        failed += 1
    }

    // Test 3: Loop that runs exactly once
    temp ran_once bool = false
    loop {
        ran_once = true
        break
    }
    if ran_once == true {
        println("  [PASS] loop runs at least once before break")
        passed += 1
    } otherwise {
        println("  [FAIL] loop did not execute body before break")
        failed += 1
    }

    // Test 4: Nested loops with break
    temp outer_count int = 0
    temp inner_total int = 0
    loop {
        if outer_count == 3 {
            break
        }
        temp inner_count int = 0
        loop {
            if inner_count == 2 {
                break
            }
            inner_total++
            inner_count++
        }
        outer_count++
    }
    // 3 outer * 2 inner = 6
    if inner_total == 6 {
        println("  [PASS] nested loops: 3 outer x 2 inner = 6 iterations")
        passed += 1
    } otherwise {
        println("  [FAIL] nested loops: expected 6, got ${inner_total}")
        failed += 1
    }

    println("")
    println("Results: ${passed} passed, ${failed} failed")

    if failed > 0 {
        println("SOME TESTS FAILED")
    } otherwise {
        println("ALL TESTS PASSED")
    }
}
