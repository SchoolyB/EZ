/*
 * string_interpolation.ez - Test string interpolation edge cases
 */

import @std
using std

do get_name() -> string {
    return "World"
}

do main() {
    println("=== String Interpolation Test ===")
    temp passed int = 0
    temp failed int = 0

    // Test 1: basic variable interpolation
    temp name string = "EZ"
    temp greeting string = "Hello, ${name}!"
    if greeting == "Hello, EZ!" {
        println("  [PASS] basic variable interpolation")
        passed += 1
    } otherwise {
        println("  [FAIL] expected 'Hello, EZ!', got '${greeting}'")
        failed += 1
    }

    // Test 2: integer interpolation
    temp x int = 42
    temp msg string = "value is ${x}"
    if msg == "value is 42" {
        println("  [PASS] integer interpolation")
        passed += 1
    } otherwise {
        println("  [FAIL] got '${msg}'")
        failed += 1
    }

    // Test 3: expression in interpolation
    temp a int = 10
    temp b int = 20
    temp result string = "sum is ${a + b}"
    if result == "sum is 30" {
        println("  [PASS] expression interpolation")
        passed += 1
    } otherwise {
        println("  [FAIL] got '${result}'")
        failed += 1
    }

    // Test 4: function call in interpolation
    temp call_result string = "Hello, ${get_name()}!"
    if call_result == "Hello, World!" {
        println("  [PASS] function call interpolation")
        passed += 1
    } otherwise {
        println("  [FAIL] got '${call_result}'")
        failed += 1
    }

    // Test 5: multiple interpolations in one string
    temp first string = "Jane"
    temp last string = "Doe"
    temp full string = "${first} ${last}"
    if full == "Jane Doe" {
        println("  [PASS] multiple interpolations")
        passed += 1
    } otherwise {
        println("  [FAIL] got '${full}'")
        failed += 1
    }

    // Test 6: bool interpolation
    temp flag bool = true
    temp bool_str string = "flag is ${flag}"
    if bool_str == "flag is true" {
        println("  [PASS] bool interpolation")
        passed += 1
    } otherwise {
        println("  [FAIL] got '${bool_str}'")
        failed += 1
    }

    // Summary
    println("")
    println("Results: ${passed} passed, ${failed} failed")

    if failed > 0 {
        println("SOME TESTS FAILED")
    } otherwise {
        println("ALL TESTS PASSED")
    }
}
