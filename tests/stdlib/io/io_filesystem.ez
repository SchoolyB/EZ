// Test new @io filesystem utility functions
// Tests glob, walk, is_symlink

import @std, @io

using std

do main() {
    // Test io.glob() - find .go files in pkg/stdlib
    temp matches, globErr = io.glob("pkg/stdlib/*.go")
    if globErr != nil {
        println("FAIL: io.glob() returned error")
        exit(1)
    }
    if len(matches) == 0 {
        println("FAIL: io.glob() should find .go files in pkg/stdlib")
        exit(1)
    }

    // Test io.glob() with no matches returns empty array
    temp noMatches, _ = io.glob("*.nonexistent_extension_xyz")
    if len(noMatches) != 0 {
        println("FAIL: io.glob() with no matches should return empty array")
        exit(1)
    }

    // Test io.walk() - walk tests directory
    temp files, walkErr = io.walk("tests/stdlib")
    if walkErr != nil {
        println("FAIL: io.walk() returned error")
        exit(1)
    }
    if len(files) == 0 {
        println("FAIL: io.walk() should find files in tests/stdlib")
        exit(1)
    }

    // Test io.is_symlink() - regular file should return false
    temp isLink string = string(io.is_symlink("go.mod"))
    if isLink != "false" {
        println("FAIL: io.is_symlink() on regular file should return false")
        exit(1)
    }

    // Test io.is_symlink() - non-existent path returns false
    temp isLink2 string = string(io.is_symlink("/nonexistent/path/xyz"))
    if isLink2 != "false" {
        println("FAIL: io.is_symlink() on non-existent path should return false")
        exit(1)
    }

    println("PASS: All io filesystem tests passed")
}
