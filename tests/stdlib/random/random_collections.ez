// Test @random module collection functions
// This test verifies choice, shuffle, and sample work correctly

import @std, @random, @arrays

using std

do main() {
    // Test random.choice()
    temp arr [int] = {1, 2, 3, 4, 5}
    temp choice int = random.choice(arr)

    if !arrays.contains(arr, choice) {
        println("FAIL: random.choice() returned value not in array")
        exit(1)
    }

    // Test random.shuffle()
    temp original [int] = {1, 2, 3, 4, 5}
    temp shuffled [int] = random.shuffle(original)

    // Check length preserved
    if len(shuffled) != len(original) {
        println("FAIL: random.shuffle() changed array length")
        exit(1)
    }

    // Check all elements present
    for_each val in original {
        if !arrays.contains(shuffled, val) {
            println("FAIL: random.shuffle() lost element")
            exit(1)
        }
    }

    // Check original unchanged
    if original[0] != 1 || original[4] != 5 {
        println("FAIL: random.shuffle() modified original array")
        exit(1)
    }

    // Test random.sample()
    temp source [int] = {10, 20, 30, 40, 50}
    temp sampled [int] = random.sample(source, 3)

    // Check correct length
    if len(sampled) != 3 {
        println("FAIL: random.sample() returned wrong length")
        exit(1)
    }

    // Check all sampled elements are from source
    for_each val in sampled {
        if !arrays.contains(source, val) {
            println("FAIL: random.sample() returned value not in source")
            exit(1)
        }
    }

    // Test random.sample(arr, 0) returns empty array
    temp emptySample [int] = random.sample(source, 0)
    if len(emptySample) != 0 {
        println("FAIL: random.sample(arr, 0) should return empty array")
        exit(1)
    }

    println("PASS: All random collection tests passed")
}
